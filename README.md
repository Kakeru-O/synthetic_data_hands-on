# 合成データハンズオン：MarimoとMostlyAIで作る安全なデータ共有基盤

## 1. プロジェクト概要
本プロジェクトは、エンジニア向けに合成データ（Synthetic Data）の有用性と、最新のPythonツールチェーンを体験してもらうためのハンズオン資料です。

### シナリオ
マーケティング部門が、キャンペーンのターゲット精度向上のため、顧客データを外部のAI解析ベンダーに提供したいと考えています。しかし、法務部門からは「個人情報保護（GDPR/APPI）」の観点からストップがかかりました。
**あなたのミッション:** 元の顧客データの統計的性質を維持しつつ、**実在する個人を一切含まない**合成データセットを作成し、データを安全に共有できることを法務部門に証明することです。

### 技術スタック
* **言語:** Python 3.10+
* **Notebook/UI:** [marimo](https://github.com/marimo-team/marimo) (リアクティブな次世代Python Notebook)
* **パッケージ管理:** [uv](https://github.com/astral-sh/uv) (超高速Pythonパッケージインストーラー)
* **合成エンジン:** [MostlyAI SDK](https://mostly.ai/)
* **データ処理・可視化:** pandas, altair, scikit-learn
* **使用データ:** Bank Marketing Data Set (UCI Machine Learning Repository)

---

## 2. ハンズオンの流れ

`app.py` は完全にインタラクティブな marimo notebook です。ユーザーはセルを上から順に実行することでシミュレーションを完了させます。

### Step 1: データ読み込み
* **データソース:** "Bank Marketing" データセットを自動的にダウンロード・読み込みます（対象カラム例: `age`, `job`, `balance`, `housing`, `loan`, `duration`, `campaign`, `y`）。
* **UI:** `marimo.ui.table` を使用して生データを表示します。
* **コンテキスト:** このデータには機微な個人属性が含まれており、このままでは外部に出せないことを説明するMarkdownを表示します。

### Step 2: 合成データの生成
* **UIコントロール:**
    * `sample_size_slider`: 生成するサンプル数を選択するスライダー（範囲: 100 - 5,000, デフォルト: 1,000）。
    * `generate_button`: 生成プロセスを開始するボタン。
* **ロジック:**
    * ボタンクリック時に、MostlyAI SDKを使用して元データから生成器（Generator）を学習させ、新しい合成データを生成します。
    * API呼び出し中はプログレスバー（スピナー）を表示します。
    * 生成された合成データのDataFrameを返します。

### Step 3: 統計的検証（「安全性」の証明）
* **ゴール:** 合成データが元データの分布を模倣していることを視覚的に証明します。
* **UIコントロール:**
    * `column_selector`: 可視化するカラムを選択するプルダウンメニュー（例: 'age', 'balance', 'job'）。
* **可視化:**
    * **Altair** を使用してヒストグラムや棒グラフを描画します。
    * 元データ（青）と合成データ（赤）の分布を**重ね合わせて**表示し、整合性を示します。
    * `column_selector` の変更に合わせてグラフがリアクティブに更新されるようにします。

### Step 4: プライバシー検証
* **ゴール:** 合成データのレコードが実在の人物のコピーではないことを確認します。
* **ロジック:** 合成データセットからランダムに1つのサンプルを選び、元データの中でそのサンプルに最も近い「最近傍（Nearest Neighbor）」を探します（数値データはユークリッド距離、カテゴリデータは一致度などで計算）。
* **UI:** 「ターゲットの合成ユーザー」と「最も似ている実在ユーザー」を横並びで比較表示します。
* **メッセージ:** 「最も似ている人でも、年齢がX歳、残高がY円異なる」といった差異を強調し、個人が特定（再識別）されないことを示します。

---

## 3. インストールと使用方法

本プロジェクトでは依存関係の管理に `uv` を使用します。

### セットアップ
```bash
# 1. リポジトリをクローン
git clone https://github.com/Kakeru-O/synthetic_data_hands-on.git
cd synthetic_data_hands-on

# 2. 依存関係の同期 (自動的に .venv が作成されます)
uv sync
```

### アプリケーションの実行
marimoサーバーを起動し、ブラウザでインタラクティブなノートブックを開きます。

```bash
uv run marimo edit app.py
```

---

## 4. 依存関係 (pyproject.toml 仕様)

* `marimo`
* `mostlyai`
* `pandas`
* `altair`
* `scikit-learn`